name: Push to any branch
on: push
jobs:
  run-tests:
    runs-on: ubuntu-20.04
    name: Run tests
    env:
      DOTNET_NOLOGO: true
      DOTNET_CLI_TELEMETRY_OPTOUT: true
      RUN_NUMBER: ${{ github.run_number }}
    steps:
      - name: Checkout
        uses: actions/checkout@v2
        with:
          ref: ${{ github.sha }}
      - name: Setup .NET Core SDK 6.0.201
        uses: actions/setup-dotnet@v1
        with:
          dotnet-version: 6.0.201
      - name: Rebuild solution
        shell: bash
        run: |
          dotnet restore ./VacationRental.Api.sln
          dotnet build ./VacationRental.Api.sln -c Release --no-restore
      - name: Run unit tests
        shell: bash
        run: |
          dotnet test ./src/VacationRental.Api.Tests.Unit/VacationRental.Api.Tests.Unit.csproj -c Release --no-build --no-restore
      - name: Run integration tests
        shell: bash
        run: |
          dotnet test ./src/VacationRental.Api.Tests.Integration/VacationRental.Api.Tests.Integration.csproj -c Release --no-build --no-restore
